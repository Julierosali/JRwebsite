'use client';

import Image from 'next/image';

type LinkItem = { platform: string; url: string; imageUrl?: string };

const ICONS: Record<string, { label: string; d: string; viewBox: string }> = {
  spotify: {
    label: 'Spotify',
    viewBox: '0 0 24 24',
    d: 'M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z',
  },
  deezer: {
    label: 'Deezer',
    viewBox: '0 0 24 24',
    d: 'M18.81 4.16v3.03h2.19V4.16h-2.19zm-2.19 0v3.03h2.19V4.16h-2.19zm-2.19 0v3.03h2.19V4.16h-2.19zm-2.19 0v3.03h2.19V4.16h-2.19zm-2.19 0v3.03h2.19V4.16h-2.19zm-2.19 0v3.03h2.19V4.16H7.86zm-2.19 0v3.03h2.19V4.16H5.67zm-2.19 0v3.03h2.19V4.16H3.48zM18.81 7.58v3.03h2.19V7.58h-2.19zm-2.19 0v3.03h2.19V7.58h-2.19zm-2.19 0v3.03h2.19V7.58h-2.19zm-2.19 0v3.03h2.19V7.58h-2.19zm-2.19 0v3.03h2.19V7.58h-2.19zm-2.19 0v3.03h2.19V7.58H7.86zm-2.19 0v3.03h2.19V7.58H5.67zm-2.19 0v3.03h2.19V7.58H3.48zM18.81 11v3.03h2.19V11h-2.19zm-2.19 0v3.03h2.19V11h-2.19zm-2.19 0v3.03h2.19V11h-2.19zm-2.19 0v3.03h2.19V11h-2.19zm-2.19 0v3.03h2.19V11h-2.19zm-2.19 0v3.03h2.19V11H7.86zm-2.19 0v3.03h2.19V11H5.67zm-2.19 0v3.03h2.19V11H3.48zM18.81 14.42v3.03h2.19v-3.03h-2.19zm-2.19 0v3.03h2.19v-3.03h-2.19zm-2.19 0v3.03h2.19v-3.03h-2.19zm-2.19 0v3.03h2.19v-3.03h-2.19zm-2.19 0v3.03h2.19v-3.03h-2.19zm-2.19 0v3.03h2.19v-3.03H7.86zm-2.19 0v3.03h2.19v-3.03H5.67zm-2.19 0v3.03h2.19v-3.03H3.48zM18.81 17.84v3.03h2.19v-3.03h-2.19zm-2.19 0v3.03h2.19v-3.03h-2.19zm-2.19 0v3.03h2.19v-3.03h-2.19zm-2.19 0v3.03h2.19v-3.03h-2.19zm-2.19 0v3.03h2.19v-3.03h-2.19zm-2.19 0v3.03h2.19v-3.03H7.86zm-2.19 0v3.03h2.19v-3.03H5.67zm-2.19 0v3.03h2.19v-3.03H3.48z',
  },
  youtube: {
    label: 'YouTube',
    viewBox: '0 0 24 24',
    d: 'M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z',
  },
  soundcloud: {
    label: 'SoundCloud',
    viewBox: '0 0 24 24',
    d: 'M1.175 12.225c-.051 0-.094.046-.101.1l-.233 2.154.233 2.105c.007.058.05.098.101.098.05 0 .09-.04.099-.098l.255-2.105-.254-2.154c-.009-.054-.049-.1-.1-.1zm-.899.099c-.06 0-.105.045-.112.1L0 14.578l.164 2.154c.007.059.052.098.112.098.058 0 .104-.039.111-.098l.19-2.154-.19-2.154c-.007-.055-.053-.1-.111-.1zm1.787-.099c-.06 0-.104.046-.111.1l-.254 2.154.254 2.105c.007.058.051.098.111.098.059 0 .104-.04.111-.098l.281-2.105-.281-2.154c-.007-.054-.052-.1-.111-.1zm.898 0c-.059 0-.104.046-.111.1l-.281 2.154.281 2.105c.007.058.052.098.111.098.06 0 .105-.04.112-.098l.307-2.105-.307-2.154c-.007-.054-.052-.1-.112-.1zm.898 0c-.06 0-.105.046-.112.1l-.307 2.154.307 2.105c.007.058.052.098.112.098.059 0 .104-.04.111-.098l.334-2.105-.334-2.154c-.007-.054-.052-.1-.111-.1zm.898 0c-.059 0-.104.046-.111.1l-.334 2.154.334 2.105c.007.058.052.098.111.098.06 0 .105-.04.112-.098l.361-2.105-.361-2.154c-.007-.054-.052-.1-.112-.1zm.898 0c-.06 0-.105.046-.112.1l-.361 2.154.361 2.105c.007.058.052.098.112.098.059 0 .104-.04.111-.098l.389-2.105-.389-2.154c-.007-.054-.052-.1-.111-.1zm.898 0c-.059 0-.104.046-.111.1l-.389 2.154.389 2.105c.007.058.052.098.111.098.06 0 .105-.04.112-.098l.416-2.105-.416-2.154c-.007-.054-.052-.1-.112-.1zm.898 0c-.06 0-.105.046-.112.1l-.416 2.154.416 2.105c.007.058.052.098.112.098.059 0 .104-.04.111-.098l.443-2.105-.443-2.154c-.007-.054-.052-.1-.111-.1zm.898 0c-.059 0-.104.046-.111.1l-.443 2.154.443 2.105c.007.058.052.098.111.098.06 0 .105-.04.112-.098l.471-2.105-.471-2.154c-.007-.054-.052-.1-.112-.1zm1.787.099v4.209c0 .6.494 1.09 1.094 1.09.6 0 1.094-.49 1.094-1.09V12.324c0-.6-.494-1.09-1.094-1.09-.6 0-1.094.49-1.094 1.09zm3.576-.099c-.6 0-1.094.49-1.094 1.09v4.209c0 .6.494 1.09 1.094 1.09.6 0 1.094-.49 1.094-1.09V12.324c0-.6-.494-1.09-1.094-1.09zm2.789 0c-.6 0-1.094.49-1.094 1.09v4.209c0 .6.494 1.09 1.094 1.09.6 0 1.094-.49 1.094-1.09V12.324c0-.6-.494-1.09-1.094-1.09zm2.789 0c-.6 0-1.094.49-1.094 1.09v4.209c0 .6.494 1.09 1.094 1.09.6 0 1.094-.49 1.094-1.09V12.324c0-.6-.494-1.09-1.094-1.09z',
  },
  amazon: {
    label: 'Amazon Music',
    viewBox: '0 0 24 24',
    d: 'M15.23 2.74c-.34-.09-.66-.14-1-.18-.36-.04-.71-.06-1.07-.06-.48 0-.94.04-1.38.12-.44.08-.86.2-1.25.36-.39.16-.74.36-1.05.61-.31.25-.57.54-.79.87-.22.33-.38.7-.5 1.11-.12.41-.18.85-.18 1.32 0 .47.06.91.18 1.32.12.41.28.78.5 1.11.22.33.48.62.79.87.31.25.66.45 1.05.61.39.16.81.28 1.25.36.44.08.9.12 1.38.12.36 0 .71-.02 1.07-.06.34-.04.66-.09 1-.18.34-.09.66-.2.96-.34.3-.14.57-.31.82-.51.25-.2.47-.43.66-.69.19-.26.33-.55.44-.87.11-.32.16-.66.16-1.03V4.63c0-.37-.05-.71-.16-1.03-.11-.32-.25-.61-.44-.87-.19-.26-.41-.49-.66-.69-.25-.2-.52-.37-.82-.51-.3-.14-.62-.25-.96-.34zm-2.23 3.49c-.28 0-.54-.05-.78-.15-.24-.1-.45-.24-.63-.42-.18-.18-.32-.39-.42-.63-.1-.24-.15-.5-.15-.78 0-.28.05-.54.15-.78.1-.24.24-.45.42-.63.18-.18.39-.32.63-.42.24-.1.5-.15.78-.15.28 0 .54.05.78.15.24.1.45.24.63.42.18.18.32.39.42.63.1.24.15.5.15.78 0 .28-.05.54-.15.78-.1.24-.24.45-.42.63-.18.18-.39.32-.63.42-.24.1-.5.15-.78.15zm6.46 2.34v9.43h-2.35v-4.43c0-.44-.02-.87-.07-1.28-.05-.41-.13-.8-.24-1.17-.11-.37-.26-.71-.44-1.02-.18-.31-.4-.58-.66-.81-.26-.23-.56-.41-.9-.55-.34-.14-.73-.21-1.16-.21-.5 0-.95.1-1.35.3-.4.2-.75.47-1.05.82-.3.35-.53.76-.69 1.23-.16.47-.24.98-.24 1.53v4.43h-2.35V8.57h2.15l.14 1.28c.2-.48.45-.9.76-1.26.31-.36.66-.65 1.06-.87.4-.22.83-.38 1.3-.48.47-.1.95-.15 1.45-.15.44 0 .85.05 1.23.15.38.1.73.25 1.05.45.32.2.6.45.85.74.25.29.45.62.61 1 .16.38.27.79.33 1.24.06.45.09.92.09 1.41z',
  },
  apple: {
    label: 'Apple Music',
    viewBox: '0 0 24 24',
    d: 'M12 2v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V2h-6z',
  },
};

export function StreamingIcons({ links }: { links: LinkItem[] }) {
  const items = links?.filter((item) => item.url) ?? [];
  if (!items.length) return null;
  return (
    <div className="mt-4">
      <span className="mb-3 block text-sm text-white/80">Ã‰couter sur :</span>
      <div className="flex flex-wrap items-center gap-3">
        {items.map((item) => {
          const icon = ICONS[item.platform.toLowerCase()];
          const label = icon?.label ?? item.platform;
          return (
            <a
              key={item.platform}
              href={item.url}
              target="_blank"
              rel="noopener noreferrer"
              className="flex h-14 w-14 items-center justify-center rounded-xl bg-white/20 transition hover:bg-violet/60 md:h-16 md:w-16"
              aria-label={label}
            >
              {item.imageUrl ? (
                <span className="relative h-10 w-10 md:h-12 md:w-12">
                  <Image
                    src={item.imageUrl}
                    alt={label}
                    fill
                    className="object-contain"
                    sizes="48px"
                    unoptimized={item.imageUrl.includes('supabase.co')}
                  />
                </span>
              ) : icon ? (
                <svg viewBox={icon.viewBox} className="h-10 w-10 fill-current md:h-12 md:w-12" aria-hidden>
                  <path d={icon.d} />
                </svg>
              ) : (
                <span className="text-lg font-medium">{item.platform[0]}</span>
              )}
            </a>
          );
        })}
      </div>
    </div>
  );
}
